{
    "Visit": {
        "type": "View:Visit",
        "creation-date": 1658759455904,
        "id": "Visit"
    },
    "login": {
        "creation-date": 1658762772118,
        "id": "login",
        "children": [
            {
                "type": "View?Data=signin-user;class=flexbox vertical;style:[width=80%;border=1px solid #ddd;borderRadius=.5rem;padding=3rem 1.5rem;gap=2rem]",
                "children": [
                    {
                        "type": "Text?class=flex;text=Login to Obeid Market;style:[fontSize=2rem;marginBottom=2rem]"
                    },
                    {
                        "type": "Input?label:[text=Username or Email;style.fontSize=1.5rem];style:[width=100%;height=4rem;borderRadius=.5rem;border=1px solid #ddd;fontSize=1.5rem];path=username"
                    },
                    {
                        "type": "Input?label:[text=Password;style.fontSize=1.5rem];password;style:[width=100%;height=4rem;borderRadius=.5rem;border=1px solid #ddd;fontSize=1.5rem];path=password;keyup:[if():[e().key=Enter]:[next().1stChild().click()]]"
                    },
                    {
                        "type": "View?class=vertical;style:[width=100%;gap=1rem]",
                        "children": [
                            {
                                "controls": [
                                    {
                                        "event": "click?loader.show?data().username;data().password",
                                        "actions": "wait():search:search?search.collection=user;search.field:[username.equal=data().username;password.equal=data().password];wait():[user:()=().search.data.value();if():[user:().id]:[setCookie():[name=_id;value=user:().id];loader.hide;route():main];search.collection=user;search.field:[email.equal=data().username;password.equal=data().password]]:[user:()=().search.data.value();if():[user:().id]:[setCookie():[name=_id;value=user:().id];loader.hide;route():main]:[loader.hide;note():[text=Username, Email, or password is incorrect!;type=danger]]]"
                                    },
                                    {
                                        "event": "click?note():[text=Fill the required blanks!]?!data().username||!data().password"
                                    }
                                ],
                                "type": "Text?class=flexbox;style:[width=100%;height=4rem;borderRadius=.5rem;backgroundColor=blue;opacity=.8;color=#fff;fontSize=1.5rem;marginTop=2rem];text=Login"
                            },
                            {
                                "children": [
                                    {
                                        "type": "Text?text='New To Obeid Market?';style:[fontSize=1.2rem]"
                                    },
                                    {
                                        "type": "Text?text=Get an account;style:[fontSize=1.2rem;color=blue;textDecoration=underline];click:[route():signup]"
                                    }
                                ],
                                "type": "View?class=horizontal;style:[gap=.4rem]"
                            }
                        ]
                    }
                ]
            }
        ],
        "type": "View:login?class=flexbox;style:[position=fixed;top=0;bottom=0;left=0;right=0]?mobile()",
        "controls": [
            {
                "event": "loaded??getCookie():_id",
                "actions": "wait():search?search.collection=user;search.doc=getCookie():_id;wait():[user:()=().search.data;if():[user:()]:[route():main]]"
            }
        ]
    },
    "main": {
        "controls": [
            {
                "event": "loaded??getCookie():_id",
                "actions": "wait():search?search.collection=user;search.doc=getCookie():_id;wait():[user:()=().search.data;if():[!user:()]:[route():login];update():user-name]"
            },
            {
                "event": "loaded?route():login?!getCookie():_id"
            }
        ],
        "creation-date": 1658743048312,
        "children": [
            {
                "type": "View?class=flexbox;style:[width=100%;height=4rem;backgroundColor=blue;position=sticky;top=0;justifyContent=space-between;padding=0 1rem]",
                "children": [
                    {
                        "type": "Icon?class=flexbox;name=menu;google.outlined;style:[fontSize=2.4rem;color=#fff;margin=auto 0]"
                    },
                    {
                        "type": "Text?text=Obeid Market;style:[fontSize=2rem;color=#fff;fontWeight=bold;position=absolute;width=16rem;left=calc(50vw - 8rem)]"
                    },
                    {
                        "children": [
                            {
                                "type": "Icon?name=person;style:[fontSize=2rem;color=#fff]?!user:()"
                            },
                            {
                                "type": "Text?text=Hi, +user:().first-name.split(): .0;style:[fontSize=1.4rem;color=#fff];droplist:[items=_list:Profile:Logout;item.style:[fontSize=1.4rem;minHeight=3.5rem]]?user:()",
                                "controls": [
                                    {
                                        "event": "click:droplist?eraseCookie():_id;route():login?droplist-txt:()=Logout"
                                    }
                                ]
                            }
                        ],
                        "type": "View:user-name?class=flexbox;style:[gap=1rem]"
                    }
                ]
            },
            {
                "type": "View:main-view"
            },
            {
                "children": [
                    {
                        "type": "View?class=flexbox vertical;style:[flex=1;transition=.2s];click:[siblings().():[children().():[style().color=#888]];children().():[style().color=blue;timer():[style().transform=scale(1.2)]:0;timer():[style().transform=scale(1)]:200]]",
                        "children": [
                            {
                                "type": "Icon?name=inventory;google.outlined;style:[fontSize=3rem;color=#888;transition=.2s]"
                            },
                            {
                                "type": "Text?text=Inventory;style:[fontSize=1.1rem;color=#888;transition=.2s]"
                            }
                        ]
                    },
                    {
                        "type": "View?class=flexbox vertical;style:[flex=1;transition=.2s];click:[siblings().():[children().():[style().color=#888]];children().():[style().color=blue;timer():[style().transform=scale(1.2)]:0;timer():[style().transform=scale(1)]:200];timer():[toggleView():[parent=main-view;view=markets]]:400]",
                        "children": [
                            {
                                "type": "Icon?name=store;google.outlined;style:[fontSize=3rem;color=#888;transition=.2s]"
                            },
                            {
                                "type": "Text?text=Markets;style:[fontSize=1.1rem;color=#888;transition=.2s]"
                            }
                        ]
                    },
                    {
                        "type": "View:sellings-btn?class=flexbox vertical;style:[flex=1;transition=.2s];click:[installApp();siblings().():[children().():[style().color=#888]];children().():[style().color=blue;timer():[style().transform=scale(1.2)]:0;timer():[style().transform=scale(1)]:200];timer():[toggleView():[parent=main-view;view=sellings]]:400]",
                        "children": [
                            {
                                "type": "Icon?name=local_mall;google.outlined;style:[fontSize=3rem;color=#888;transition=.2s]"
                            },
                            {
                                "type": "Text?text=Sales;style:[fontSize=1.1rem;color=#888;transition=.2s]"
                            }
                        ]
                    },
                    {
                        "children": [
                            {
                                "type": "Icon?name=grid_view;google.outlined;style:[fontSize=3rem;color=#888;transition=.2s]"
                            },
                            {
                                "type": "Text?text=Products;style:[fontSize=1.1rem;color=#888;transition=.2s]"
                            }
                        ],
                        "type": "View?class=flexbox vertical;style:[flex=1;transition=.2s];click:[siblings().():[children().():[style().color=#888]];children().():[style().color=blue;timer():[style().transform=scale(1.2)]:0;timer():[style().transform=scale(1)]:200];timer():[toggleView():[parent=main-view;view=products]]:400]"
                    },
                    {
                        "type": "View?class=flexbox vertical;style:[flex=1;transition=.2s];click:[siblings().():[children().():[style().color=#888]];children().():[style().color=blue;timer():[style().transform=scale(1.2)]:0;timer():[style().transform=scale(1)]:200]]",
                        "children": [
                            {
                                "type": "Icon?name=storefront;google.outlined;style:[fontSize=3rem;color=#888;transition=.2s]"
                            },
                            {
                                "type": "Text?text=Home;style:[fontSize=1.1rem;color=#888;transition=.2s]"
                            }
                        ]
                    }
                ],
                "type": "View:bottom-navbar?class=box-shadow-1 grid;style:[position=fixed;height=6rem;width=100%;backgroundColor=#f6f6f6;padding=0 1rem;gridTemplateColumns=1fr 1fr 1fr 1fr 1fr;bottom=0;left=0;right=0;zIndex=1;opacity=0];loaded:[timer():[style().opacity=1]:600]"
            },
            {
                "type": "View?view=new-selling"
            }
        ],
        "type": "View:main?style:[position=relative]?mobile()",
        "id": "main"
    },
    "markets": {
        "id": "markets",
        "creation-date": 1658744205858,
        "children": [
            {
                "type": "View:new-market?Data=new-market;class=vertical;style:[position=fixed;padding=1rem;paddingBottom=3rem;top=0;left=0;right=0;bottom=0;overflowY=auto;opacity=0;pointerEvents=none;transition=.2s;backgroundColor=#fff;gap=2rem;zIndex=2]",
                "children": [
                    {
                        "type": "View?class=flex align-center;if():[!new-market:()||new-market:().keys().len()=0]:[new-market:()=_map:created-by:[user:().id]:created-by-name:[user:().first-name+ +user:().last-name]:creation-date:[today().timestamp()]:day:todayStart():month:monthStart():year:yearStart():id:[gen():20]:visits:0:sales:0:total-sales:0];style:[minHeight=4rem;padding=0 1rem;borderLeft=3px solid blue;width=100%;backgroundColor=#f6f6f6]",
                        "children": [
                            {
                                "type": "Text?text=New Market;style:[fontSize=2rem]"
                            }
                        ]
                    },
                    {
                        "type": "View?class=vertical;style:[flex=1;width=100%;gap=2rem;paddingTop=1rem]",
                        "children": [
                            {
                                "type": "Input?path=name;label:[text=Market Name;fontSize=1.2rem];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];keyup:[data()=data().capitalize();txt()=data()]"
                            },
                            {
                                "type": "Input?path=owner-name;label:[text=Owner Name;fontSize=1.2rem];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];keyup:[data()=data().capitalize();txt()=data()]"
                            },
                            {
                                "type": "Input?path=city;label:[text=City;fontSize=1.2rem];readonly;style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];droplist.items=_list:Beirut:Baalbeck;droplist.item.style:[minHeight=3.5rem;fontSize=1.3rem]"
                            },
                            {
                                "type": "Input?path=district;label:[text=District;fontSize=1.2rem];readonly;style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];droplist.items=_list:Dahyeh:Chouifet;droplist.item.style:[minHeight=3.5rem;fontSize=1.3rem]"
                            },
                            {
                                "type": "Input?path=address;textarea;label:[text=Address;fontSize=1.2rem];style:[width=100%;minHeight=8rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem]"
                            },
                            {
                                "type": "Input?path=contact-number;label:[text=Contact Number;fontSize=1.2rem];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem]"
                            },
                            {
                                "children": [
                                    {
                                        "controls": [
                                            {
                                                "event": "click?loader.show;save():[collection=agent;data=new-market:()]:[if():[!markets:().find():[id=new-market:().id]]:[markets:().push():[new-market:().clone()].sort():[path=last-visit;descending]]:[markets:().pullItem():[id=new-market:().id];markets:().push():[new-market:().clone()]];new-market:().del();update():market-list;():new-market.style():[opacity=0;pointerEvents=none];edit-market:().del();loader.hide]?data().name;data().city;data().district;data().address;data().contact-number;data().owner-name"
                                            }
                                        ],
                                        "type": "View?class=flexbox;style:[width=100%;height=3.5rem;borderRadius=1.5rem;opacity=.8;backgroundColor=blue]",
                                        "children": [
                                            {
                                                "type": "Text?text=if():[!edit-market:()]:[Add Market]:Save;style:[color=#fff;fontSize=1.4rem]"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "View?class=flexbox;style:[width=100%;height=3.5rem;borderRadius=1.5rem;opacity=.8;backgroundColor=#888];click:[():new-market.style():[opacity=0;pointerEvents=none];edit-market:().del()]",
                                        "children": [
                                            {
                                                "type": "Text?text=Cancel;style:[color=#fff;fontSize=1.4rem]"
                                            }
                                        ]
                                    }
                                ],
                                "type": "View?class=grid;style:[gap=5rem;gridTemplateColumns=1fr 1fr;marginTop=auto;paddingTop=1rem]"
                            }
                        ]
                    }
                ]
            },
            {
                "type": "View?class=flexbox;style:[width=100%;height=6rem;padding=1rem;gap=1rem;justifyContent=space-between]",
                "children": [
                    {
                        "type": "Text?class=flexbox;text=Markets;style:[height=3.5rem;padding=0 1rem;fontSize=2rem;borderLeft=3px solid blue]"
                    },
                    {
                        "type": "View?class=flexbox;style:[gap=1rem]",
                        "children": [
                            {
                                "children": [
                                    {
                                        "type": "Icon?name=search;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]"
                            },
                            {
                                "children": [
                                    {
                                        "type": "Icon?name=add;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ],
                                "controls": [
                                    {
                                        "event": "click?new-market:()=_map;update():new-market;():new-market.style():[opacity=1;pointerEvents=auto]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]"
                            }
                        ]
                    }
                ]
            },
            {
                "children": [
                    {
                        "children": [
                            {
                                "type": "[View]?Data=markets;class=flex vertical;style:[gap=1rem;padding=1rem;width=100%;backgroundColor=#fff]",
                                "children": [
                                    {
                                        "type": "View?class=flex vertical;style:[width=100%;gap=1rem]",
                                        "children": [
                                            {
                                                "type": "View?class=flexbox;style:[width=100%;justifyContent=space-between]",
                                                "children": [
                                                    {
                                                        "type": "Text?text=data().name;class=flexbox;style:[fontSize=1.8rem;color=blue;height=3rem]"
                                                    },
                                                    {
                                                        "type": "Icon?name=edit;style:[height=3rem;width=3rem;fontSize=2rem;color=#888];google.outlined",
                                                        "controls": [
                                                            {
                                                                "event": "click?edit-market:()=true;new-market:()=data().clone();update():new-market;():new-market.style():[opacity=1;pointerEvents=auto]"
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "Text?text=data().city+, +data().district+, +data().address+', mobile: '+data().contact-number;style:[fontSize=1.4rem;width=100%]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "children": [
                                                            {
                                                                "type": "Text?text=if():[data().total-sales]:Total Sales;style:[fontSize=1.3rem;color=#888]"
                                                            },
                                                            {
                                                                "type": "Text?text=data().total-sales.price();style:[fontSize=1.3rem;color=#888]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem;marginRight=auto]",
                                                        "controls": [
                                                            {
                                                                "event": "click?loader.show;market-sellings:()=true;search():[collection=selling;field.market.equal=data().id]:[sellings:()=().search.data.values().sort():[path=selling-date;descending];loader.hide;():sellings-btn.click()]"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "children": [
                                                            {
                                                                "type": "Text?text=if():[data().last-visit]:Last visit;style:[fontSize=1.3rem;color=#888]"
                                                            },
                                                            {
                                                                "type": "Text?text=data().last-visit.toDateFormat();style:[fontSize=1.3rem;color=#888]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem]"
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[width=100%;justifyContent=flex-end;borderTop=1px solid #ddd;padding=.5rem]"
                                            },
                                            {
                                                "type": "View?class=vertical;style:[width=100%;display=none;gap=1rem]",
                                                "children": [
                                                    {
                                                        "type": "[Visit]?class=vertical;path=visits?false"
                                                    }
                                                ]
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "children": [
                                                            {
                                                                "type": "Icon?name=markunread_mailbox;google.outlined;style:[fontSize=1.8rem]"
                                                            },
                                                            {
                                                                "type": "Text?text=Visit;style:[fontSize=1.3rem]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem;paddding=.5rem]"
                                                    },
                                                    {
                                                        "type": "View?class=horizontal;style:[gap=.5rem;padding=.5rem]",
                                                        "controls": [
                                                            {
                                                                "event": "click?new-selling:()=_map:created-by:[user:().id]:created-by-name:[user:().first-name+ +user:().last-name]:creation-date:[today().timestamp()]:id:[gen():20]:selling-date:todayStart():sales:[_list:_map]:market:[data().id]:market-name:[data().name];update():new-selling;():new-selling.style():[opacity=1;pointerEvents=auto];my-market:()=data().clone()"
                                                            }
                                                        ],
                                                        "children": [
                                                            {
                                                                "type": "Icon?name=local_mall;google.outlined;style:[fontSize=2.2rem]"
                                                            },
                                                            {
                                                                "type": "Text?text=Sell;style:[fontSize=1.3rem;marginTop=.4rem]"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "controls": [
                                                            {
                                                                "event": "click?share():[text='Market: '+data().name+' | Address: '+data().city+, +data().district+, +data().address+' | Mobile: '+data().contact-number]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem;padding=.5rem]",
                                                        "children": [
                                                            {
                                                                "type": "Icon?name=share;google.outlined;style:[fontSize=1.8rem]"
                                                            },
                                                            {
                                                                "type": "Text?text=Share;style:[fontSize=1.3rem]"
                                                            }
                                                        ]
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[justifyContent=space-between;paddingTop=.5rem]"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ],
                        "type": "View?class=vertical;style:[width=100%;gap=1rem;paddingTop=1rem;paddingBottom=7rem]?markets:().len()>0"
                    }
                ],
                "controls": [
                    {
                        "event": "loaded?search():[collection=agent]:[markets:()=[().search.data.values()||_list].sort():[path=last-visit;descending];update():market-list]"
                    }
                ],
                "type": "View:market-list?class=vertical;style:[width=100%;gap=1rem;backgroundColor=#eee;minHeight=100vh]"
            }
        ],
        "type": "View:markets?markets:()=_list"
    },
    "new-selling": {
        "children": [
            {
                "children": [
                    {
                        "type": "Text?text=New Selling;style:[fontSize=2rem]"
                    }
                ],
                "type": "View?class=flex align-center;if():[!new-selling:()]:[new-selling:()=_map:created-by:[user:().id]:created-by-name:[user:().first-name+ +user:().last-name]:creation-date:[today().timestamp()]:day:todayStart():month:monthStart():year:yearStart():id:[gen():20]:selling-date:todayStart():sales:[_list:_map]];style:[minHeight=4rem;padding=0 1rem;borderLeft=3px solid blue;width=100%;backgroundColor=#f6f6f6]"
            },
            {
                "children": [
                    {
                        "type": "Input?input.value=data().market-name;label:[text=Market Name;fontSize=1.2rem];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];#if():[data().market]:[droplist.items='my-markets:().():name';droplist.item.style:[minHeight=3.5rem;fontSize=1.3rem]]",
                        "controls": [
                            {
                                "event": "input??!data().market"
                            }
                        ]
                    },
                    {
                        "controls": [
                            {
                                "event": "input?data()=data().timestamp()"
                            }
                        ],
                        "type": "Input?if():[!data().selling-date]:[data().selling-date=todayStart()];path=selling-date;input:[type=date;value=data().toDateInputFormat()];label:[text=Date;fontSize=1.2rem];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem]"
                    },
                    {
                        "type": "View?class=vertical;style:[gap=1rem]",
                        "children": [
                            {
                                "children": [
                                    {
                                        "type": "Text?text=#;style:[color=#888;fontSize=1.2rem;flex=1]"
                                    },
                                    {
                                        "type": "Text?text=Product;style:[color=#888;fontSize=1.2rem;flex=1]"
                                    },
                                    {
                                        "type": "Text?text=Unit;style:[color=#888;fontSize=1.2rem;flex=1]"
                                    },
                                    {
                                        "type": "Text?text=Price L.L.;style:[color=#888;fontSize=1.2rem;flex=1]"
                                    },
                                    {
                                        "type": "Text?text=Qty;style:[color=#888;fontSize=1.2rem;flex=1]"
                                    }
                                ],
                                "type": "View?class=horizontal;style:[display=grid;width=100%;gap=.5rem;gridTemplateColumns=1.5rem 4fr 2fr 2fr 1fr 1.5rem]"
                            },
                            {
                                "type": "View?class=vertical;style:[gap=1rem;flex=1]",
                                "children": [
                                    {
                                        "type": "[View]?class=horizontal;path=sales;style:[display=grid;gap=.5rem;gridTemplateColumns=1.5rem 4fr 2fr 2fr 1fr 1.5rem]",
                                        "children": [
                                            {
                                                "type": "Text?class=flexbox;text=parent().mapIndex+1;style:[fontSize=1.3rem;flex=1]"
                                            },
                                            {
                                                "type": "Input?path=product-name;style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem]"
                                            },
                                            {
                                                "type": "Input?if():[!data().unit]:[data().unit=Box];path=unit;readonly;style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];droplist.items=_list:Box:Bottle:Piece;droplist.item.style:[minHeight=3.5rem;fontSize=1.3rem]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "type": "Input?if():[!data().price]:[data().price=0];class=price;path=price;input:[type=number;value=data().divide():1000];style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];keyup:[data()=txt()*1000;update():total-price;update():total-qty]"
                                                    },
                                                    {
                                                        "type": "Text?class=flexbox;text=',000';style:[color=blue;fontSize=1.3rem]"
                                                    }
                                                ],
                                                "type": "View?class=horizontal;style:[gap=.2rem]"
                                            },
                                            {
                                                "type": "Input?if():[!data().qty]:[data().qty=0];class=qty;path=qty;input.type=number;style:[width=100%;height=4rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem];keyup:[update():total-price;update():total-qty]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "type": "Icon?class=flexbox;name=remove;google.outlined;style:[fontSize=2rem;width=100%]"
                                                    }
                                                ],
                                                "controls": [
                                                    {
                                                        "event": "click?Data().sales.pullItem():data();update():[parent().parent().parent()];update():total-price;update():total-qty"
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[height=100%;width=100%]"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "type": "View:total-new-sale?class=flexbox;style:[display=grid;width=100%;gap=.5rem;gridTemplateColumns=1.5rem 4fr 2fr 2fr 1fr 1.5rem;borderTop=1px solid #ddd;padding=1rem 0;height=5rem]",
                                "children": [
                                    {
                                        "type": "View?class=flexbox",
                                        "children": [
                                            {
                                                "type": "Icon?name=add;google.outlined;style:[fontSize=2rem]"
                                            }
                                        ],
                                        "controls": [
                                            {
                                                "event": "click?Data().sales.push():_map;update():[parent().prev()]"
                                            }
                                        ]
                                    },
                                    {
                                        "type": "View"
                                    },
                                    {
                                        "type": "View"
                                    },
                                    {
                                        "children": [
                                            {
                                                "type": "Text?class=flex;text=;style:[fontSize=1.3rem;color=blue;padding=.5rem];loaded:[data().total-price=parent().parent().prev().children().():[className():price.0.data().num()*className():qty.0.data().num()].sum();txt()=data().total-price.price()]"
                                            }
                                        ],
                                        "type": "View:total-price"
                                    },
                                    {
                                        "type": "View:total-qty",
                                        "children": [
                                            {
                                                "type": "Text?class=flex;text=;style:[fontSize=1.3rem;color=blue;padding=.5rem];loaded:[data().total-qty=className():qty.():[data().num()].sum();txt()=data().total-qty]"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "Input?path=note;textarea;label:[text=Notes;fontSize=1.2rem];style:[width=100%;minHeight=8rem;border=1px solid #ddd;fontSize=1.3rem;borderRadius=.5rem]"
                    },
                    {
                        "children": [
                            {
                                "controls": [
                                    {
                                        "event": "click?loader.show;save():[collection=selling;data=new-selling:()]:[my-market:()._():[_.visits=_.visits+1;_.sales=_.sales+1;_.total-sales=_.total-sales+new-selling:().total-price;_.last-visit=today().timestamp()];save():[collection=agent;data=my-market:()];#sellings:().push():[new-selling:().clone()];#update():selling-list;markets:().pullItem():[id=my-market:().id];markets:().push():[my-market:()].sort():[path=last-visit;descending];update():market-list;():new-selling.style():[opacity=0;pointerEvents=none];new-selling:().del();loader.hide]?data().market;data().selling-date;!data().products.find():[!name]"
                                    }
                                ],
                                "children": [
                                    {
                                        "type": "Text?text=Sold;style:[color=#fff;fontSize=1.4rem]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[width=100%;height=3.5rem;borderRadius=1.5rem;opacity=.8;backgroundColor=blue]"
                            },
                            {
                                "children": [
                                    {
                                        "type": "Text?text=Cancel;style:[color=#fff;fontSize=1.4rem]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[width=100%;height=3.5rem;borderRadius=1.5rem;opacity=.8;backgroundColor=#888];click:[():new-selling.style():[opacity=0;pointerEvents=none]]"
                            }
                        ],
                        "type": "View?class=grid;style:[gap=5rem;gridTemplateColumns=1fr 1fr;marginTop=auto]"
                    }
                ],
                "type": "View?class=vertical;style:[flex=1;width=100%;gap=2rem;padding=2rem 0]"
            }
        ],
        "id": "new-selling",
        "type": "View:new-selling?Data=new-selling;class=vertical;style:[position=fixed;padding=1rem;top=0;left=0;right=0;bottom=0;overflowY=auto;opacity=0;pointerEvents=none;transition=.2s;backgroundColor=#fff;gap=2rem;zIndex=2]",
        "creation-date": 1658765496074
    },
    "products": {
        "type": "View:products?if():[!products:()]:[products:()=_list]",
        "children": [
            {
                "type": "View?class=flexbox;style:[width=100%;height=6rem;padding=1rem;gap=1rem;justifyContent=space-between]",
                "children": [
                    {
                        "type": "Text?class=flexbox;text=Products;style:[height=3.5rem;padding=0 1rem;fontSize=2rem;borderLeft=3px solid blue]"
                    },
                    {
                        "type": "View?class=flexbox;style:[gap=1rem]",
                        "children": [
                            {
                                "children": [
                                    {
                                        "type": "Icon?name=search;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]"
                            },
                            {
                                "controls": [
                                    {
                                        "event": "click?update():new-product;():new-product.style():[opacity=1;pointerEvents=auto]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]",
                                "children": [
                                    {
                                        "type": "Icon?name=add;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "children": [
                    {
                        "type": "View?class=vertical;style:[display=grid;gridTemplateColumns=1fr 1fr;width=100%;gap=1rem;paddingTop=1rem;paddingBottom=7rem]?products:().len()>0",
                        "children": [
                            {
                                "type": "[View]?Data=products;class=flex vertical;style:[gap=1rem;padding=1rem;width=100%;backgroundColor=#fff]",
                                "children": [
                                    {
                                        "type": "View?class=flex vertical;style:[width=100%;gap=1rem]"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "type": "View:product-list?class=vertical;style:[width=100%;gap=1rem;backgroundColor=#eee;minHeight=100vh]",
                "controls": [
                    {
                        "event": "loaded?if():[!market-sellings:()]:[search():[collection=selling]:[sellings:()=().search.data.values().sort():[path=selling-date;descending];update():selling-list]]:[market-sellings:()=false]"
                    }
                ]
            }
        ],
        "id": "products",
        "creation-date": 1659451967287
    },
    "sellings": {
        "type": "View:sellings?if():[!sellings:()]:[sellings:()=_list]",
        "children": [
            {
                "type": "View?class=flexbox;style:[width=100%;height=6rem;padding=1rem;gap=1rem;justifyContent=space-between]",
                "children": [
                    {
                        "type": "Text?class=flexbox;text=Sales;style:[height=3.5rem;padding=0 1rem;fontSize=2rem;borderLeft=3px solid blue]"
                    },
                    {
                        "type": "View?class=flexbox;style:[gap=1rem]",
                        "children": [
                            {
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]",
                                "children": [
                                    {
                                        "type": "Icon?name=search;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ]
                            },
                            {
                                "children": [
                                    {
                                        "type": "Icon?name=add;google.outlined;style:[color=#888;fontSize=2rem]"
                                    }
                                ],
                                "type": "View?class=flexbox;style:[height=3.5rem;width=3.5rem;border=1px solid #ddd;borderRadius=.5rem]",
                                "controls": [
                                    {
                                        "event": "click?update():new-selling;():new-selling.style():[opacity=1;pointerEvents=auto]"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "type": "View:selling-list?class=vertical;style:[width=100%;gap=1rem;backgroundColor=#eee;minHeight=100vh]",
                "controls": [
                    {
                        "event": "loaded?if():[!market-sellings:()]:[search():[collection=selling]:[sellings:()=().search.data.values().sort():[path=selling-date;descending];update():selling-list]]:[market-sellings:()=false]"
                    }
                ],
                "children": [
                    {
                        "type": "View?class=vertical;style:[width=100%;gap=1rem;paddingTop=1rem;paddingBottom=7rem]?sellings:().len()>0",
                        "children": [
                            {
                                "type": "[View]?Data=sellings;class=flex vertical;style:[gap=1rem;padding=1rem;width=100%;backgroundColor=#fff]",
                                "children": [
                                    {
                                        "type": "View?class=flex vertical;style:[width=100%;gap=1rem]",
                                        "children": [
                                            {
                                                "children": [
                                                    {
                                                        "type": "Text?text=data().market-name;class=flexbox;style:[fontSize=1.8rem;color=blue;height=3rem]"
                                                    },
                                                    {
                                                        "type": "Text?text=data().total-price.price()+' L.L';class=flexbox;style:[fontSize=1.8rem;color=red;height=3rem]"
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[width=100%;justifyContent=space-between]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "type": "View?class=horizontal align-center;style:[display=grid;width=100%;gap=.5rem;gridTemplateColumns=1.5rem 4fr 2fr 2fr 1fr;height=2.5rem;backgroundColor=#ddd;padding=.5rem;borderRadius=.25rem]",
                                                        "children": [
                                                            {
                                                                "type": "Text?text=#;style:[color=#666;fontSize=1.2rem;flex=1]"
                                                            },
                                                            {
                                                                "type": "Text?text=Product;style:[color=#666;fontSize=1.2rem;flex=1]"
                                                            },
                                                            {
                                                                "type": "Text?text=Unit;style:[color=#666;fontSize=1.2rem;flex=1]"
                                                            },
                                                            {
                                                                "type": "Text?text=Price L.L.;style:[color=#666;fontSize=1.2rem;flex=1]"
                                                            },
                                                            {
                                                                "type": "Text?text=Qty;style:[color=#666;fontSize=1.2rem;flex=1]"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "View?class=vertical;style:[gap=.5rem;flex=1]",
                                                        "children": [
                                                            {
                                                                "type": "[View]?class=horizontal;path=sales;style:[display=grid;gap=.5rem;gridTemplateColumns=1.5rem 4fr 2fr 2fr 1fr;padding=0 .5rem]",
                                                                "children": [
                                                                    {
                                                                        "type": "Text?class=horizontal;text=parent().mapIndex+1;style:[fontSize=1.3rem;flex=1]"
                                                                    },
                                                                    {
                                                                        "type": "Text?class=horizontal;text=data().product-name;style:[width=100%;fontSize=1.3rem]"
                                                                    },
                                                                    {
                                                                        "type": "Text?class=horizontal;text=data().unit;style:[width=100%;fontSize=1.3rem]"
                                                                    },
                                                                    {
                                                                        "type": "Text?class=horizontal;text=data().price.price();style:[width=100%;fontSize=1.3rem]"
                                                                    },
                                                                    {
                                                                        "type": "Text?class=horizontal;text=data().qty;style:[width=100%;fontSize=1.3rem]"
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ],
                                                "type": "View?class=vertical;style:[gap=.5rem;width=100%;transition=.2s;overflow=hidden]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "children": [
                                                            {
                                                                "type": "Text?text=Date:;style:[fontSize=1.3rem;color=#888]?false"
                                                            },
                                                            {
                                                                "type": "Text?text=data().selling-date.toDateFormat();style:[fontSize=1.3rem;color=#888]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem]"
                                                    },
                                                    {
                                                        "type": "View?class=horizontal;style:[gap=.5rem]",
                                                        "children": [
                                                            {
                                                                "type": "Text?text=Seller:;style:[fontSize=1.3rem;color=#888]?false"
                                                            },
                                                            {
                                                                "type": "Text?text=data().created-by-name;style:[fontSize=1.3rem;color=#888]"
                                                            }
                                                        ]
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[width=100%;justifyContent=space-between;borderTop=1px solid #ddd;padding=.5rem]"
                                            },
                                            {
                                                "children": [
                                                    {
                                                        "controls": [
                                                            {
                                                                "event": "click?html2pdf():[view=parent().parent().parent();size=A6]"
                                                            }
                                                        ],
                                                        "type": "View?class=horizontal;style:[gap=.5rem;paddding=.5rem];closed=false",
                                                        "children": [
                                                            {
                                                                "type": "Icon?name=receipt_long;google.outlined;style:[fontSize=1.8rem]"
                                                            },
                                                            {
                                                                "type": "Text?text=Receipt;style:[fontSize=1.3rem]"
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "type": "View?class=horizontal;style:[gap=.5rem;padding=.5rem]",
                                                        "controls": [
                                                            {
                                                                "event": "click?share():[text='Market: '+data().market-name+' | Price: '+data().total-price.price()+' L.L. | Date: '+data().selling-date.toDateInputFormat()+' | Seller: '+data().created-by-name]"
                                                            }
                                                        ],
                                                        "children": [
                                                            {
                                                                "type": "Icon?name=share;google.outlined;style:[fontSize=1.8rem]"
                                                            },
                                                            {
                                                                "type": "Text?text=Share;style:[fontSize=1.3rem]"
                                                            }
                                                        ]
                                                    }
                                                ],
                                                "type": "View?class=flexbox;style:[justifyContent=space-between;paddingTop=.5rem]"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ],
        "id": "sellings",
        "creation-date": 1658779408265
    }
}